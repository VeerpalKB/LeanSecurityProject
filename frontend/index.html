<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Secure System Verification</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div class="container">
        <h1> Secure System Verification</h1>
        <p>Select a security property to verify:</p>

        <form id="verification-form">
            <label for="property">Choose a property:</label>
            <select id="property" name="property">
                <option value="authentication">User Authentication</option>
                <option value="access_control">Access Control</option>
                <option value="encryption">Encryption Integrity</option>
            </select>

            <button type="button">Verify</button>
        </form>

<div class="output">
  <p><strong>Output:</strong></p>
  <p id="output">Waiting for verification...</p>
</div>

<div id="explanation-panel" style="display:none; margin-top:20px; padding:15px; border:1px solid #ccc;">
  <p><strong>Verification Explanation:</strong></p>
  <ul id="explanation-list"></ul>
</div>

    </div>

<script>
  document.querySelector("button").onclick = async () => {
    const property = document.querySelector("#property").value;

    try {
      const response = await fetch(`/verify?property=${property}`);
      const data = await response.json();

      document.getElementById("output").innerText = data.output;
      showExplanation(property, data.output);
    } catch (error) {
      document.getElementById("output").innerText =
        "Verification service not available.";
    }
  };

function showExplanation(property, output) {
  const panel = document.getElementById("explanation-panel");
  const list = document.getElementById("explanation-list");

  list.innerHTML = "";
  panel.style.display = "block";

  // ACCESS CONTROL — VERIFIED
  if (
    property === "access_control" &&
    output.toLowerCase().includes("verified")
  ) {
    const explanations = [
      "✔ Property verified: Access Control Security",
      "✔ Verified users: Alice, Bob",
      "✖ Rejected users: Eve",
      "✔ Reason: Only authorised users are permitted access to protected resources."
    ];

    explanations.forEach(text => {
      const li = document.createElement("li");
      li.innerText = text;
      list.appendChild(li);
    });

    return;
  }

  // ACCESS CONTROL — FAILED (future-proof)
  if (property === "access_control") {
    const li = document.createElement("li");
    li.innerText =
      "✖ Access control property could not be verified.";
    list.appendChild(li);
    return;
  }

  // OTHER PROPERTIES (NOT IMPLEMENTED YET)
  const li = document.createElement("li");
  li.innerText =
    "This security property is not yet implemented in the current prototype.";
  list.appendChild(li);
}
</script>

</body>
</html>